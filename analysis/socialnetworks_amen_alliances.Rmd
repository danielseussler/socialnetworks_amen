---
title: The Additive and Multiplicative Effects Network Model
subtitle: Seminar on Statistical Modeling of Social Networks
author: Daniel A. Seussler Becerra
date: "June 2021"
output:
  bookdown::pdf_document2: 
    fig_caption: yes
classoption: twoside
fontsize: 11pt
toc: false
geometry: margin=1in 
bibliography: 
  - references.bib
header-includes:
  - \usepackage{float}
  - \usepackage{url}
  - \usepackage{setspace}\onehalfspacing
  - \usepackage{natbib}\bibliographystyle{apa}
keywords: Social Networks, Dyadic Data, Bayesian estimation, Latent Factors, International Relations.
abstract: "This seminar paper introduces the Additive and Multiplicative Effects Network Model as proposed in @Hoff2021. First, a general introduction to network and relational data is given along with the statistical challenges of dyadic data analysis. Then, the Additive and Multiplicative Effects (AME) network model ist introduced and motivated. Second, an application to the international interstate alliances network is presented along with a comparison with restricted modeling approaches. The paper concludes with an outlook on extensions of the AME model. *Keywords: Dyadic Data, Bayesian Estimation, Latent Factors, International Relations.*"
thanks: "Replication files are available on Github (http://github.com/danielseussler). **Current version**: `r format(Sys.time(),'%B %d, %Y')`; **Corresponding author**: daniel.seussler@campus.lmu.de"
nocite: |
  @Hoff2007, @Hoff2005,
---

\newpage
# Introduction
Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor.Aenean ma ssa. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec quam felis, ultricies nec, pellentesque eu, pretium quis, sem. Nulla consequat massa quis enim. Donec pede justo, fringilla vel, aliquet nec, vulputate eget, arcu. In enim justo, rhoncus ut, imperdiet a, venenatis vitae, justo. Nullam dictum felis eu pede mollis pretium. Integer tincidunt. Cras dapibus. Vivamus elementum semper nisi. Aenean vulputate eleifend tellus. Aenean leo ligula, porttitor eu, consequat vitae, eleifend ac, enim. Aliquam lorem ante, dapibus in, viverra quis, feugiat a, tellus. Phasellus viverra nulla ut metus varius laoreet. Quisque rutrum. Aenean imperdiet. Etiam ultricies nisi vel augue. Curabitur ullamcorper ultricies nisi. Nam eget dui. Etiam rhoncus. Maecenas tempus, tellus eget condimentum rhoncus, sem quam semper libero, sit amet adipiscing sem neque sed ipsum. Nam quam nunc, blandit vel, luctus pulvinar, hendrerit id, lorem. Maecenas nec odio et ante tincidunt tempus. Donec vitae sapien ut libero venenatis faucibus. Nullam quis ante. Etiam sit amet orci eget eros faucibus tincidunt. Duis leo. Sed fringilla mauris sit amet nibh. Donec sodales sagittis magna. Sed consequat, leo eget bibendum sodales, augue velit cursus nunc,


# Theory
Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec quam felis, ultricies nec, pellentesque eu, pretium quis, sem. Nulla consequat massa quis enim. Donec pede justo, fringilla vel, aliquet nec, vulputate eget, arcu. In enim justo, rhoncus ut, imperdiet a, venenatis vitae, justo. Nullam dictum felis eu pede mollis pretium. Integer tincidunt. Cras dapibus. Vivamus elementum semper nisi. Aenean vulputate eleifend tellus. Aenean leo ligula, porttitor eu, consequat vitae, eleifend ac, enim. Aliquam lorem ante, dapibus in, viverra quis, feugiat a, tellus. Phasellus viverra nulla ut metus varius laoreet. Quisque rutrum. Aenean imperdiet. Etiam ultricies nisi vel augue. Curabitur ullamcorper ultricies nisi. Nam eget dui. Etiam rhoncus. Maecenas tempus, tellus eget condimentum rhoncus, sem quam semper libero, sit amet adipiscing sem neque sed ipsum. Nam quam nunc, blandit vel, luctus pulvinar, hendrerit id, lorem. Maecenas nec odio et ante tincidunt tempus. Donec vitae sapien ut libero venenatis faucibus. Nullam quis ante. Etiam sit amet orci eget eros faucibus tincidunt. Duis leo. Sed fringilla mauris sit amet nibh. Donec sodales sagittis magna. Sed consequat, leo eget bibendum sodales, augue velit cursus nunc,


**Network Effects** 

* 1st-order: Sender (Receiver) Effects
* 2nd-order: Reciprocity
* 3rd-order: Homophily & Stochastic Equivalence
* System-level - changing actor composition



**Additive Effects: The Social Relations Model**

Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec quam felis, ultricies nec, pellentesque eu, pretium quis, sem. Nulla consequat massa quis enim. Donec pede justo, fringilla vel, aliquet nec, vulputate eget, arcu. In enim justo, rhoncus ut, imperdiet a, venenatis vitae, justo. Nullam dictum felis eu pede mollis pretium. Integer tincidunt. Cras dapibus. Vivamus elementum semper nisi. Aenean vulputate eleifend tellus. Aenean leo ligula, porttitor eu, consequat vitae, eleifend ac, enim. Aliquam lorem ante, dapibus in, viverra quis, feugiat a, tellus. Phasellus viverra nulla ut metus varius laoreet. Quisque rutrum. Aenean imperdiet. Etiam ultricies nisi vel augue. Curabitur ullamcorper ultricies nisi. Nam eget dui. Etiam rhoncus. Maecenas tempus, tellus eget condimentum rhoncus, sem quam semper libero, sit amet adipiscing sem neque sed ipsum. 
```{=latex}
\begin{align*}
\begin{aligned}
      y_{ij} &= \mu + e_{ij} \\
      e_{ij} &= a_{i} + b_{j} + \epsilon_{ij} \\
      \{ (a_{1}, b_{1}), \ldots, (a_{n}, b_{n}) \} &\sim N(0,\Sigma_{ab}) \\ 
      \{ (\epsilon_{ij}, \epsilon_{ji}) : \; i \neq j\} &\sim N(0,\Sigma_{\epsilon}), \text{ where } \\
      \Sigma_{ab} = \begin{pmatrix} \sigma_{a}^{2} & \sigma_{ab} \\ 
      \sigma_{ab} & \sigma_{b}^2   \end{pmatrix} \;\;\;\;\; &\Sigma_{\epsilon} = \sigma_{\epsilon}^{2} \begin{pmatrix} 1 & \rho \\ 
      \rho & 1  \end{pmatrix}
\end{aligned}
\end{align*}
```
Nam quam nunc, blandit vel, luctus pulvinar, hendrerit id, lorem. Maecenas nec odio et ante tincidunt tempus. Donec vitae sapien ut libero venenatis faucibus. Nullam quis ante. Etiam sit amet orci eget eros faucibus tincidunt. Duis leo. Sed fringilla mauris sit amet nibh. Donec sodales sagittis magna. Sed consequat, leo eget bibendum sodales, augue velit cursus nunc.


**Multiplicative Effects: The Latent Factor Model**

Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec quam felis, ultricies nec, pellentesque eu, pretium quis, sem. Nulla consequat massa quis enim. Donec pede justo, fringilla vel, aliquet nec, vulputate eget, arcu. In enim justo, rhoncus ut, imperdiet a, venenatis vitae, justo. Nullam dictum felis eu pede mollis pretium. Integer tincidunt. Cras dapibus. Vivamus elementum semper nisi.
```{=latex}
\begin{align*}
  {\textbf{u}_{i},\textbf{v}_{j}} \in \mathbb{R}^{k} \;\; i,j \in \{1, \ldots, n \} \\
\end{align*}
```
Nam quam nunc, blandit vel, luctus pulvinar, hendrerit id, lorem. Maecenas nec odio et ante tincidunt tempus. Donec vitae sapien ut libero venenatis faucibus. Nullam quis ante. Etiam sit amet orci eget eros faucibus tincidunt. Duis leo. Sed fringilla mauris sit amet nibh. Donec sodales sagittis magna. Sed consequat, leo eget bibendum sodales, augue velit cursus nunc. 

```{=latex}
\begin{align*}
\begin{aligned}
  \gamma(\textbf{u}_{i}, \textbf{v}_{j}) &= \textbf{u}_{i}^{T} D \textbf{v}_{j} \\
  &= \sum_{k \in K} d_{k} u_{ik} v_{jk} \\
  &D \text{ is a  } K \times K \text{ diagonal matrix}
\end{aligned}
\end{align*}
```
Nam quam nunc, blandit vel, luctus pulvinar, hendrerit id, lorem. Maecenas nec odio et ante tincidunt tempus. Donec vitae sapien ut libero venenatis faucibus. Nullam quis ante. Etiam sit amet orci eget eros faucibus tincidunt. Duis leo. Sed fringilla mauris sit amet nibh. Donec sodales sagittis magna. Sed consequat, leo eget bibendum sodales, augue velit cursus nunc.


**The AME Model: Additive + Multiplicative Effects**

Nam quam nunc, blandit vel, luctus pulvinar, hendrerit id, lorem. Maecenas nec odio et ante tincidunt tempus. Donec vitae sapien ut libero venenatis faucibus. Nullam quis ante. Etiam sit amet orci eget eros faucibus tincidunt. Duis leo. Sed fringilla mauris sit amet nibh. Donec sodales sagittis magna. Sed consequat, leo eget bibendum sodales, augue velit cursus nun.
```{=latex}
\begin{align*}
  \begin{aligned}
      y_{ij,t} &= g(\theta_{ij,t}) \\ 
      &\theta_{ij,t} = \beta^{T} \mathbf{X}_{ij,t} + e_{ij,t} \\
      &e_{ij,t} = a_{i} + b_{j}  + \epsilon_{ij} + \alpha(\textbf{u}_{i}, \textbf{v}_{j}) \text{  , where } \\
      &\qquad \alpha(\textbf{u}_{i}, \textbf{v}_{j}) = \textbf{u}_{i}^{T} \textbf{D} \textbf{v}_{j} = \sum_{k \in K} d_{k} u_{ik} v_{jk} \\ 
  \end{aligned}
\end{align*}
```
Nam quam nunc, blandit vel, luctus pulvinar, hendrerit id, lorem. Maecenas nec odio et ante tincidunt tempus. Donec vitae sapien ut libero venenatis faucibus. Nullam quis ante. Etiam sit amet orci eget eros faucibus tincidunt. Duis leo. Sed fringilla mauris sit amet nibh. Donec sodales sagittis magna. Sed consequat, leo eget bibendum sodales, augue velit cursus nunc.

-@minhas_hoff_ward_2019
-@Hoff2021


**Parameter Estimation and Goodness of Fit**

Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec quam felis, ultricies nec, pellentesque eu, pretium quis, sem. Nulla consequat massa quis enim. Donec pede justo, fringilla vel, aliquet nec, vulputate eget, arcu. In enim justo, rhoncus ut, imperdiet a, venenatis vitae, justo. Nullam dictum felis eu pede mollis pretium. Integer tincidunt. Cras dapibus. Vivamus elementum semper nisi. Aenean vulputate eleifend tellus. Aenean leo ligula, porttitor eu, consequat vitae, eleifend ac, enim. Aliquam lorem ante, dapibus in, viverra quis, feugiat a, tellus. Phasellus viverra nulla ut metus varius laoreet. Quisque rutrum. Aenean imperdiet. Etiam ultricies nisi vel augue. Curabitur ullamcorper ultricies nisi. Nam eget dui. Etiam rhoncus. Maecenas tempus, tellus eget condimentum rhoncus, sem quam semper libero, sit amet adipiscing sem neque sed ipsum. Nam quam nunc, blandit vel, luctus pulvinar, hendrerit id, lorem. Maecenas nec odio et ante tincidunt tempus. Donec vitae sapien ut libero venenatis faucibus. Nullam quis ante. Etiam sit amet orci eget eros faucibus tincidunt. Duis leo. Sed fringilla mauris sit amet nibh. Donec sodales sagittis magna. Sed consequat, leo eget bibendum sodales, augue velit cursus nunc,


**Extensions**

*1. Count, Ordinal and Censored Data*

- @hoff2015longitudinal

*2. Missing Data*


*3. Longitudinal Networks* The last 

\newpage
# Application Case: Interstate Defence Alliances
To illustrate the purpose of network analysis approaches we turn our attention to the field of international relations. More specifically, I apply the beforehand introduced AME network model to the interstate defense alliances network in the year 2000. Alliance formation in an interstate framework provides an interesting application case, both because of the availability of data and the assumed extent of network effects inherent in the strategic decisions of state actors. Neglecting the latter effects by presuming conditional independence of observations, as in the classical regression framework, could seriously bias parameter estimates (@statIssue).

The data is an excerpt from the data used in @ComplexDependencies and @TowardNetwork and contains the yearly defense network as a time series from 1981 to 2000.^[The data set `alliances` can be conveniently accessed as network data in the R-Package `xergm.common`.] It furthermore includes information on military capabilities, political regime types, geographic borders and interstate conflict. From here on out, I refer to this data set as the alliances data set. 

The analysis is structured as follows. First, restricted to a cross-sectional study of the year 2000, I examine the alliances structure with respect to the network statistics and preliminary models. Second, to motivate the statistical network approach, I estimate four different specifications and compare these with respect to their goodness of fit. I conclude with a discussion of challenges and improvements of the AME network model.The computational analysis was implemented with the R-Software (@rsoftware) and the AMEN R-Package (@ramen).

```{r setup, echo=FALSE, message=FALSE}
# These options are tuned for manuscript/presentation.
# They basically run R in the background except for spitting out figures/tables

knitr::opts_chunk$set(
	echo = FALSE,
	error = FALSE,
	message = FALSE,
	warning = FALSE
)

library(amen)
library(xergm.common)
library(network)
library(statnet)
library(kableExtra)
library(tidyverse)
data("alliances")
set.seed(42)

```

```{r output_help, include=FALSE}
# Modified summary function of amen package to output a table easier to handle
table_ame <- function(object, ...){ 
  fit <- object
  tmp <- cbind(
    apply(fit$BETA, 2, mean), apply(fit$BETA, 2, sd),
    
    2 * (1 - pnorm(abs(apply(fit$BETA, 2, mean) / apply(fit$BETA, 2, sd))))
  )
  colnames(tmp) <- c("pmean", "psd", "p - value")
  out <- round(tmp, 3)
  
  
  tmp <- cbind(apply(fit$VC, 2, mean), apply(fit$VC, 2, sd))
  tmp <- cbind(round(tmp, 3), array("-", dim = c(nrow(tmp), 1)))

  out <- rbind(out, tmp)
  return(out)
} 
```

```{r alliancesfigure, fig.cap = "The interstate defense alliance network in the year 2000. Countries with no interstate alliance recorded are ommitted from the plot.", fig.align = "center", out.height="95%"}
knitr::include_graphics("figures/alliancesplot.pdf")
```


**Network Statistics**

The alliances data set includes 159^[This data set covers the period of 1981 - 2000, it includes all countries which were selected at any time of given series. I exclude the Yemen Arab Republic, Yemen People's Republic, German Democratic Republic, German Federal Republic, and Czechoslovakia as former countries, which yields a total of 159 countries.] countries and a total of 767 observed interstate alliances. In the respective sociomatrix, a value of 1 indicates the presence of an alliance between two countries, 0 its absence. Note that we have a symmetric matrix, as an alliance between two states is taken to be not directed. 56 countries have no alliance recorded in the data set, the United States and Canada declare the most, with 43 and 39 alliances respectively. The median number of alliances is 9 and the network density is 0.061.

A visualization of the interstate alliance network is provided in Figure \@ref(fig:alliancesfigure). Strong clustering on based geographic proximity is immediately apparent. Located in the upper right of the figure we find the Middle East, below France in the center are the European states. In the left we find the former USSR countries, in the lower part Latin America and the Caribbean states. Perhaps more surprisingly there are two distinct clusters of African states.

Observed statistics of network dependence will be used later on to assess model fit and are computed as described above. First order statistics, the standard deviation of the row- and columnmeans is 0.057. As our sociomatrix is symmetric, second order dependency is 1. Third order statistics are 0.389, both for the cycle and transitive dependency, because of symmetry.



**Model Comparison: Interstate Defence Alliances**

I follow the specification of @dynamicAMEN and @geometryofsecurity to define nodal and dyadic covariates which are both sensible to the approach and relevant to the theoretic discussion of interstate alliance networks.^[@dynamicAMEN present a dynamic extension of the AME network model. In @geometryofsecurity the author proceeds with a *stochastic actor-oriented* approach for the analysis of longitudinal network data. The covariates of interest however are transferable although not directly comparable.] 

*1. Nodal Covariates.* As covariate of interest specific to each actor in the network, I include Gross Domestic Product (GDP) in per capita terms and on log scale for each country using data from @wdigdppc. Missing data is imputed with 0 values. ^[Adding as a measure for military capability the *Composite Index of National Capability* (CINC), appended in the alliances data set, did not improve model fit during preliminary modeling. It is therefore omitted from the analysis.]

*2. Dyadic Covariates.* As dyadic effects I include covariates on geographic factors, political and military similarity, past conflicts, economic dependence, and cultural similarity. The covariates are defined as follows: 

1. $GeoDistance_{ij}$ is the logarithmic geographic distance between two countries as measured by the distance of the respective capitals. If the two countries share a border, the log distance is set 0. 
2. $CulturalSim_{ij}$ is a dichotomous variable which takes the value 1, if the most spoken language of two countries is the same, 0 else.^[I use data from the replication files of @geometryofsecurity and choose the year 1985 since the year 2000 did not seem to be accurate. @culturalsimdata is provided as the original data source.] 
3. $EconomicDep_{ij}$ is a measure for the economic dependence of two states, calculated by the share of Imports and Exports to GDP: 
  $$EconomicDep_{ij} = min\left(\frac{Trade_{ij}}{GDP_i}, \frac{Trade_{ij}}{GDP_j} \right) \cdot 100\%$$
  To construct this index, I take data from the Correlates of War Project on trade flows (@tradedata) and @wdigdp. 
4. $SharedAllies_{ij}$ is the number of shared allies between country $i$ and $j$. 
5. $ConflictInd_{ij}$ is an indicator variable which takes the value 1 if a militarized interstate dispute was recorded in the preceding 10 years between country $i$ and $j$. 
6. $PoliticalSim_{ij}$ is constructed using data from the Polity IV Index: 
  $$PoliticalSim_{ij} = \lvert POLITY_i - POLITY_j \rvert$$
7. $CapabilityRat_{ij}$ The capability ratio is defined as the log of the relative *Composite Index of National Capability* of both countries, with the stronger state (indicated by the subscript *s*) as the numerator: 
  $$CapRat_{ij} = \log\left(\frac{CINC_s}{CINC_w}\right).$$
Because the CINC index is calculated only for countries which surpass a certain threshold, data is missing for a set of #CHECK countries. For these countries the Capability Ratio is set at 0.

Note that each dyadic covariate is symmetric. To validate the network approach taken in this application case, I estimate four models with different restrictions. One with additive and multiplicative effects (AME), one with only additive effects (AE), one with only multiplicative effects (ME), and one without any types of random effects (NO). The latter one yields a classical (bayesian) probit regression, which does not take into account any type of network effects. This serves as benchmark for our extended modeling. The results presented in this section are based on 100,000 Gibbs iterations and a burn-in of 10,000 draws. Output density is set at 100. This long sampling and stark thinning is due to symmetric network matrices, which results in considerably slow mixing of the MCMC chains [see @hoff2015dyadic, p. 44].

As elaborated in the subsection on Estimation and Goodness of Fit, model assessment is performed using the goodness of fit statistics of the posterior predictive draws. Figure \@ref(fig:gofstats) illustrates this comparison for our models. The red line indicates the observed goodness of fit statistic. On the left, we have a comparison of first order effects, on the right, third order effects. As our matrix is symmetric, second order dependence is obsolete and thus omitted. 

The first row compares the ordinary (bayesian) probit regression (NO) with the additive effects (AE) model. Predictably, the the former (pink) does barely represent the network dependencies present in the data. Adding additive effects does improve this representation (blue), an overestimated first order effect does probably account for the high third order network effect. Still, both models are not able to capture the extent of dependency. In the second row, the additive effects (AE) model is compared to the multiplicative effects model (ME, R = 2), which does improve model fit considerably. First order effects are captured very well, representation of third order effects has improved. Comparing multiplicative effects (green) with the full AME Model (grey, third row), both R = 2, shows the best fit with respect to the goodness of fit statistics. 

```{r models}
fitZNII0H <- readRDS(file = "models/fitZNII0H.rds") # AME R=2
fitCPLTUK <- readRDS(file = "models/fitCPLTUK.rds") # Additive Effects
fitX7XDFO <- readRDS(file = "models/fitX7XDFO.rds") # Multiplicative Effects R = 2
fitDASD8R <- readRDS(file = "models/fitDASD8R.rds") # No Effects
```

```{r gofstats, fig.cap = "Pairwise comparison (row-wise) of posterior predictive distributions of the goodness of fit statistics for the ordinary regression (pink), only additive effects (blue), only multiplicative effects (green), and both additive and multiplicative effects (grey).", fig.align = "center", out.height="90%"}
knitr::include_graphics("figures/gofstats.pdf")
```

```{r modelcomparison1, results='asis'}
modelAMEvsNO <- cbind(table_ame(fitZNII0H), 
                      table_ame(fitDASD8R))

modelAMEmsg <- paste("Effective Sample Size: ", toString(round(coda::effectiveSize(fitZNII0H$BETA))), ".", sep = "")
modelNOmsg <- paste("Effective Sample Size: ", toString(round(coda::effectiveSize(fitDASD8R$BETA))), ".", sep ="") 

modelAMEvsNO[10:11, 4:5] <- "-"

kbl(modelAMEvsNO, booktabs = T, caption = "Model Comparison") %>%
  kable_styling(full_width = T) %>%
  column_spec(1, width = "4cm") %>%
  pack_rows("Additive Effects", 10, 11, latex_gap_space = "1em") %>%
  add_header_above(c(" " = 1 , "AME Network Model (R=2)" = 3, "Probit Regression" = 3)) %>%
  footnote(number = c(modelAMEmsg, modelNOmsg))
```

```{r modelcomparison2, results='asis'}
modelAEvsME <- cbind(table_ame(fitCPLTUK), 
                     table_ame(fitX7XDFO))

modelAMmsg <- paste("Effective Sample Size: ", toString(round(coda::effectiveSize(fitCPLTUK$BETA))), ".", sep = "") 
modelMEmsg <- paste("Effective Sample Size: ", toString(round(coda::effectiveSize(fitX7XDFO$BETA))), ".", sep = "") 

modelAEvsME[10:11, 4:5] <- "-"

kbl(modelAEvsME, booktabs = T, caption = "Model Comparison") %>%
  kable_styling(full_width = T) %>%
  column_spec(1, width = "4cm") %>%
  pack_rows("Additive Effects", 10, 11, latex_gap_space = "1em") %>%
  add_header_above(c(" " = 1 , "Additive Effects" = 3, "Multiplicative Effects (R=2)" = 3)) %>%
  footnote(number = c(modelAMmsg, modelMEmsg))
```

```{r traceplotAMEr2, fig.cap ="Trace Plots for the AME Rank 2 Model. Trending and multimodality is visible for several parameter chains of the mcmc estimation.", fig.align='center', out.height="90%"}
knitr::include_graphics("figures/traceplotAmeR2.pdf")
```

Table \@ref(tab:modelcomparison1) and \@ref(tab:modelcomparison2) provide parameter estimates for the above discussed four specifications. Estimates are provided as posterior means, along with the posterior standard deviation and a $p$ - value.^[The $p$ - value is calculated under the assumption of an approximately normal posterior distribution (#REFERENCE). Yet, the $p$ - value should be interpreted with caution, as the density plots do not always suggest approximate normality.] Different specifications lead to vastly different estimates, not only in magnitude but also in changes of the sign. 

The coefficients of the fixed effects can be interpreted as in the generalized linear regression framework with a probit link, i.e., a joint language (coef. 0.65) increases ceteris paribus (c. p.) and *conditional* on the additive and multiplicative effects the likelihood of the presence of an alliance. A higher geographic distance decreases the likelihood, c. p. and conditional on the random effects. Directionally, only the coefficients of the geographic distance and cultural similarity match @geometryofsecurity. 

Figure \@ref(fig:traceplotAMEr2) shows the trace plots of the parameter estimates for the AME R=2 model. Both multimodality and strong trending are apparent, specifically for the additive effect and the intercept, which suggests problems with the mcmc estimation. This is also indicated by the low effective sample size (Table \@ref(tab:modelcomparison1)) for the specifications including multiplicative effects.

Having detailed the fixed effects part of the AME model we turn to the analysis of the random effects of the model. Figure \@ref(fig:LatentSpaceAME) visualizes the latent space obtained with the rank 2 AME model. The multiplicative effect in a symmetric model is $U^T L U$, where $U \in \mathbb{R}^{159 \times 2}$ and $L \in \mathbb{R}^{2 \times 2}$. Both $U$ and $L$ are provided as posterior means in the package output, to visualize the latent space $u_{i} = U_{i \cdot } \sqrt{L}$ for $i = 1, \dots, 159$ is plotted.

```{r LatentSpaceAME, fig.cap = "Visualization of the latent space in the AME model with rank 2. Values are posterior mean estimates for the multiplicative random effects. Proximity in the latent space indicates similarity in the alliances data set. ", fig.align = "center", out.width="95%"}
knitr::include_graphics("figures/LatentSpaceAME.pdf")
```

Apart from the scatter in the center of the plot, the multiplicative effects capture some interesting geographical factors, which were already apparent in figure \@ref(fig:alliancesfigure), and are not captured within the $GeoDistance_{ij}$ fixed effect. This includes the Americas in the left and at least two distinct clusters of African states. The United States and Russia take as former Block powers positions at the oposite sides. 

```{r AdditiveEffects, fig.cap = "Additive Random Effects"}
knitr::include_graphics("figures/AdditiveEffectsPlot.pdf")
```

Additive effects are plotted in \@ref(fig:AdditiveEffects). 







- Robustness Checks

- Does a higher R Latent Factor yield better results?
- Does a higher R Latent Factor yield better results? restricted to M Effects
- Does dropping variables improve model performance?






**Limitations and Further Approaches**



  

The network density^[This calculation takes into account every state in the data.] ranges from `r round(range(gden(allyNet, mode = "digraph"))[1], 3)` to `r round(range(gden(allyNet, mode = "digraph"))[2], 3)` in the time-frame 1981 - 2000. Assuming this low density as a reliable characteristic of the interstate alliance network, stronger priors, specifically for the intercept, could be selected. Opposite trending of intercept and additive effects does indicate an over-identification issue, which could be minimized through this.



\newpage
# Discussion

- Discussion




Further applications can be found in the following papers: @violenceNetworks apply the AME network model to study the civil conflict in Nigeria and the implications of the emergence of Boko Haram. @Minhas_Hoff_Ward_2016 use a time series approach of the AME network model to study international relations, in this case the type of interaction chosen by each state. @dynamicAMEN model UN Voting Behaviour with a longitudinal extension which relies on Gaussian processes. 

\newpage
# References
